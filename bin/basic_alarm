#!/usr/bin/env python

#import asyncio
import seattle_sunrise

def a_main_func():
    ## create instances
    eg = seattle_sunrise.EventGetter()
    lf = seattle_sunrise.bulbz_control(headers_file='/usr/local/secrets/hass_auth.yaml')
    elc = seattle_sunrise.event_loop_control()
    ## bind them
    elc.get_events = eg.get_events
    action_map = {
        'wake': lf.on_interval,
    }
    lf.action_map = action_map
    actor_map = {
        'alarmclock': lf,
    }
    elc.actor_map = actor_map
    ## execute
    elc()

if __name__ == "__main__":
    a_main_func()
